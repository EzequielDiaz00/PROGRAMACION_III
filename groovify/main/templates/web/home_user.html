<!DOCTYPE html>
<html lang="es">
{% load static %}
{% load song_filters %}

<head>
  <!-- Metadatos y archivos est√°ticos -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Groovify UGB - M√∫sica en Streaming</title>
  <link rel="stylesheet" href="{% static 'css/css2.css' %}">
  <link rel="icon" href="{% static 'img/favicon.ico' %}" type="image/x-icon">
</head>

<body>
  <!-- Barra de navegaci√≥n -->
  <header class="navbar">
    <div class="logo">
      <h1>Groovify</h1>
    </div>
    <br>
    <nav>
      <ul>
        <li>
          <!-- Mostrar el correo del usuario si est√° autenticado -->
          {% if email %}
          <p>Bienvenido, <strong>{{ email }}</strong></p>
          {% else %}
          <p>Bienvenido, invitado</p>
          {% endif %}
        </li>
        <li>
          <!-- Bot√≥n de cerrar sesi√≥n -->
          <a href="{% url 'logout' %}" onclick="return confirm('¬øEst√°s seguro de que deseas cerrar sesi√≥n?')">
            Cerrar Sesi√≥n
          </a>
        </li>
      </ul>
    </nav>
  </header>

  <!-- Secci√≥n principal -->
  <main>
    <section id="main" class="featured-song-player">
      <!-- Lista de canciones y barra de b√∫squeda -->
      <section class="featured-song">
        <h2>Lista de canciones</h2>
        <br>
        <form method="get" action="{% url 'home_user' %}" class="search-form">
          <input type="text" name="query" placeholder="Buscar canciones..." class="search-input">
          <button type="submit" class="search-button">Buscar</button>
        </form>
        <ul class="song-list">
          {% for song_url in song_urls|sort_by_artist %}
          <li class="song-item" data-file="{{ song_url }}">
            {{ song_url|extract_song_name }}
          </li>
          {% empty %}
          <li>No se encontraron canciones.</li>
          {% endfor %}
        </ul>
      </section>

      <!-- Reproductor de m√∫sica -->
      <section id="player" class="player">
        <img src="{% static 'img/favicon.webp' %}" alt="portada-song" class="portada-song">
        <div id="player_controls" class="player-controls">
          <button id="player_back">‚èÆÔ∏è</button>
          <button id="player_play">‚ñ∂Ô∏è</button>
          <button id="player_pause">‚è∏</button>
          <button id="player_stop">‚èπÔ∏è</button>
          <button id="player_skip">‚è≠Ô∏è</button>
          <!-- Control de volumen -->
          <label for="volumeControl">üîä</label>
          <input id="volumeControl" type="range" min="0" max="1" step="0.01" value="1" class="volume-slider">
        </div>
        <br>
        <div id="song_info" class="song-info">
          <p>Selecciona una canci√≥n para reproducir</p>
        </div>
        <br>
        <div id="song-time-info">
          <span id="current-time">00:00</span> / <span id="remaining-time">00:00</span>
        </div>
        <input id="progressbarSong" type="range" min="0" max="100" value="0" class="progress-bar">
      </section>
    </section>
  </main>

  <!-- Scripts -->
  <script>
    const playlist = [];
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.song-item').forEach(item => {
        playlist.push(item.dataset.file); // Agregar canciones a la lista de reproducci√≥n
      });
    });
  </script>
  <script src="{% static 'js/dashboardUser.js' %}"></script>

  <!-- Pie de p√°gina -->
  <footer>
    <p>&copy; 2024 Groovify. Todos los derechos reservados.</p>
  </footer>
</body>

</html>
